---
id: apply
title: Apply()
sidebar_label: Apply()
---

#### NOTE: 
  - `Apply()` is a query run against our `float64` and `int64` columns types. For more information on using these data types in FeatureBase, visit [ingest](TODO) documentation and the following HTTP API endpoints (TODO).
  - `Apply()` is currently limited to the community version only. It's is not applicable to cloud at this time.

The `Apply()` query uses the map / reduce framework to compute on float64 and int64 data types. In FeatureBase, data is sharded by records. Meaning, a single table is split into multiple shards or segements by records. A single shard contains the data for some subset of records in that index. For this reason, Apply() takes two arguments (`MAP_FUNCTION` and `REDUCE_FUNCTION`) which are written in Ivy. Ivy is an APL-like language. The source code for ivy can be found [here](https://github.com/robpike/ivy). If you haven't seen ivy before, [this demo](https://github.com/robpike/ivy/blob/master/demo/demo.ivy) is a good place to start to get familiar with it. Read the mandatory arguments section below for more on the map and reduce phases.

## Call Definition

```pql
Apply(ROW_CALL, MAP_FUNCTION, REDUCE_FUNCTION)
```

#### Mandatory Arguments
- `ROW_CALL` : the output of any [row call](/pql-guide/pql-introduction#Crow-calls){:target="_blank"} (set of record IDs / keys). Only data for records returned here will make it to the `MAP_FUNCTION`. Filter records as much as possible here to improve performance.
- `MAP_FUNCTION` : ivy function to be performed at the shard level. This function will run records from each shard (think subset of records) that are returned by `ROW_CALL`. In most cases, it's best to perform as much work at this phase as possible. The output from each shard is passed to the reduce phase. 
- `REDUCE_FUNCTION` : ivy query to be performed on the aggregation or concatenation of the output of the `MAP_FUNCTION`. The input of the reduce phase is the output of the map phase. You're guarenteed to get


#### Optional Arguments
#### Returns
- A list of float64 or int64 values
    
## Examples

### Data:

```
Index: weather (non keyed)

  _id  | events (keyed set) |  min_temp (float64) | max_temp (float64) | rainfall (float64)
-------+--------------------+---------------------+--------------------+--------------------
   0   |    cloudy          |        8.0          |      24.3          |        0.0
   1   |    rain,cloudy     |       14.0          |      26.9          |        3.6
   2   |    sunny           |       13.7          |      23.4          |        0.0
   3   |    cloudy          |       13.3          |      15.5          |        2.9
```
-----------------------------------------------------------------------
### Example 1
Return all the record IDs in the `customer` index 

#### Query
```
[customer]All()
```
#### Tabular Response
#### HTTP Response
```json
{
  "results": [
    {
      "columns": [
        0,
        1,
        2,
        3,
        4,
        5
      ]
    }
  ]
}
```
#### Explanation:
0, 1, 2, 3, 4, and 5 are all the record IDs in the index


---
### Example 2
Return all the record keys in the `customer_keyed` index

#### Query
```
[customer_keyed]All()
```
#### Tabular Response
```
 _id
-----
 a
 b
 c
 d
 e
 f
```
#### HTTP Response
```json
{
  "results": [
    {
      "columns": [],
      "keys": [
        "a",
        "b",
        "c",
        "d",
        "e",
        "f"
      ]
    }
  ]
}
```
#### Explanation:
a, b, c, d, e, and f are all the record keys in the index
